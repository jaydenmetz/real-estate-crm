================================================================================
REAL ESTATE CRM - COMPLETE FILE TREE
Generated: $(date '+%Y-%m-%d %H:%M:%S')
================================================================================

This document provides a comprehensive view of the project structure,
excluding node_modules, .git, build artifacts, and archived files.

================================================================================
ROOT DIRECTORY
================================================================================

.
├── CLAUDE.md                    # AI assistant configuration
├── README.md                    # Project documentation
├── docker-compose.yml           # Docker configuration
├── railway.json                 # Railway deployment config
├── all-code.txt                 # Combined codebase export
├── COMPLETE_FILE_TREE.txt       # This file
├── .env.example                 # Environment template
│
├── api-docs/                    # API documentation
├── docs/                        # Project documentation
│   ├── DDD_STRUCTURE.md
│   ├── COMPLETE_ROADMAP.md
│   ├── PROGRESS_TRACKER.md
│   └── ...
├── scripts/                     # Build and utility scripts
│   ├── combine.sh
│   └── ...
│
├── backend/                     # Node.js/Express API
└── frontend/                    # React SPA

================================================================================
BACKEND STRUCTURE (Domain-Driven Design)
================================================================================

backend/
├── package.json
├── .env.example
│
├── migrations/                  # Database migrations (52 files)
│   ├── 001_initial_crm_setup.sql
│   ├── ...
│   └── 052_add_representation_type.sql
│
├── scripts/                     # Backend utility scripts
│   ├── auth/                    # Authentication scripts
│   ├── data/                    # Data management
│   ├── database/                # DB utilities
│   ├── production/              # Production scripts
│   └── testing/                 # Test utilities
│
└── src/
    ├── app.js                   # Express app setup
    ├── server.js                # Server entry point
    │
    ├── config/
    │   ├── infrastructure/      # DB, Redis config
    │   ├── integrations/        # External services
    │   ├── schemas/             # Validation schemas
    │   └── statuses/            # Status configurations
    │
    ├── jobs/                    # Scheduled jobs
    │   ├── scheduler.js
    │   ├── kpiSnapshot.job.js
    │   └── securityEventRetention.job.js
    │
    ├── lib/                     # Shared libraries
    │   ├── ai/                  # AI services
    │   ├── auth/                # Auth utilities
    │   ├── communication/       # Notifications, alerts
    │   ├── external/            # External APIs
    │   ├── infrastructure/      # WebSocket, cache
    │   └── security/            # Security services
    │
    ├── middleware/
    │   ├── auth/                # JWT, API key auth
    │   ├── business/            # Business logic middleware
    │   ├── errors/              # Error handling
    │   ├── logging/             # Request logging
    │   └── security/            # Rate limiting, CORS
    │
    ├── routes/                  # Platform routes
    │   ├── platform/            # AI, analytics, health
    │   └── security/            # API keys, GDPR
    │
    ├── utils/                   # Utility functions
    │
    └── modules/                 # DDD MODULES (Domain-Driven Design)
        │
        ├── core-modules/        # PRIMARY BUSINESS ENTITIES
        │   ├── escrows/
        │   │   ├── __tests__/
        │   │   ├── controllers/
        │   │   │   ├── crud.controller.js
        │   │   │   ├── manager.controller.js
        │   │   │   └── sub-resources/
        │   │   │       ├── checklists.controller.js
        │   │   │       ├── details.controller.js
        │   │   │       ├── financials.controller.js
        │   │   │       ├── people.controller.js
        │   │   │       └── timeline.controller.js
        │   │   ├── models/
        │   │   ├── routes/
        │   │   ├── services/
        │   │   │   ├── schema.service.js
        │   │   │   ├── commission.service.js
        │   │   │   └── commission/
        │   │   └── utils/
        │   │
        │   ├── clients/
        │   │   ├── __tests__/
        │   │   ├── controllers/
        │   │   ├── models/
        │   │   ├── routes/
        │   │   └── services/
        │   │       └── clients.service.js    # Updated: budget field
        │   │
        │   ├── leads/
        │   │   ├── __tests__/
        │   │   ├── controllers/
        │   │   ├── models/
        │   │   ├── routes/
        │   │   └── services/
        │   │       ├── leads.service.js       # Updated: budget field
        │   │       ├── leadRouting.service.js
        │   │       └── leadScoring.service.js
        │   │
        │   └── appointments/
        │       ├── __tests__/
        │       ├── controllers/
        │       ├── models/
        │       ├── routes/
        │       └── services/
        │
        ├── operations/          # DAY-TO-DAY OPERATIONS
        │   ├── listings/
        │   │   ├── __tests__/
        │   │   ├── controllers/
        │   │   ├── models/
        │   │   ├── routes/
        │   │   ├── services/
        │   │   └── utils/
        │   │
        │   └── documents/
        │       ├── constants/
        │       ├── controllers/
        │       ├── models/
        │       ├── routes/
        │       └── services/
        │
        ├── crm/                 # CUSTOMER RELATIONSHIP
        │   └── contacts/
        │       ├── __tests__/
        │       ├── controllers/
        │       ├── models/
        │       ├── routes/
        │       └── services/
        │
        ├── system/              # PLATFORM FEATURES
        │   ├── auth/
        │   ├── admin/
        │   ├── broker/
        │   ├── teams/
        │   ├── users/
        │   ├── preferences/
        │   ├── statuses/
        │   ├── stats/
        │   ├── onboarding/
        │   ├── waitlist/
        │   └── link-preview/
        │
        ├── workflow/            # TASK/PROJECT MANAGEMENT
        │   ├── calendar/
        │   ├── projects/
        │   └── tasks/
        │
        ├── financial/           # MONEY OPERATIONS
        │   ├── commissions/
        │   ├── invoices/
        │   └── expenses/
        │
        └── integration/         # EXTERNAL SYSTEMS
            ├── communications/
            ├── webhooks/
            └── skyslope/

================================================================================
FRONTEND STRUCTURE (React + Config-Driven Architecture)
================================================================================

frontend/
├── package.json
├── .env.example
├── public/
│
└── src/
    ├── index.js                 # App entry point
    ├── App.jsx                  # Root component
    │
    ├── config/                  # ENTITY CONFIGURATIONS
    │   ├── entities/
    │   │   ├── escrows.config.js
    │   │   ├── clients.config.js    # Updated: budget, commission stats
    │   │   ├── leads.config.js
    │   │   ├── listings.config.js
    │   │   ├── appointments.config.js
    │   │   └── statusGroups.js
    │   │
    │   ├── statuses/
    │   │   ├── index.js
    │   │   ├── statusCategories.js  # Updated: CLIENT_CATEGORIES
    │   │   └── statusDefinitions.js
    │   │
    │   ├── navigation.config.js
    │   └── sentry.js
    │
    ├── contexts/                # REACT CONTEXTS
    │   ├── AuthContext.jsx
    │   ├── PrivacyContext.jsx
    │   └── StatusContext.jsx
    │
    ├── hooks/                   # CUSTOM HOOKS
    │   ├── useEscrowCalculations.js
    │   ├── useResponsiveLayout.js
    │   ├── useUserPreference.js
    │   └── useWebSocket.js
    │
    ├── services/                # API SERVICES
    │   ├── api.service.js       # Centralized API with JWT refresh
    │   ├── auth.service.js
    │   ├── websocket.service.js
    │   ├── checklists.service.js
    │   ├── healthCheck.service.js
    │   ├── networkMonitor.service.js
    │   ├── onboarding.service.js
    │   ├── preferences.service.js
    │   ├── projects.service.js
    │   ├── statuses.service.js
    │   └── tasks.service.js
    │
    ├── utils/                   # UTILITIES
    │   ├── formatters.js
    │   ├── validators.js
    │   ├── safeDateUtils.js     # Timezone-safe date handling
    │   ├── sortUtils.js
    │   ├── sanitize.js
    │   ├── auth.js
    │   ├── globalErrorHandler.js
    │   ├── googleMapsLoader.js
    │   ├── streetViewUtils.js
    │   └── config/
    │       └── createEntityConfig.js
    │
    ├── templates/               # REUSABLE TEMPLATES
    │   ├── Dashboard/
    │   │   ├── index.jsx        # DashboardTemplate
    │   │   ├── components/
    │   │   │   ├── DashboardContent.jsx
    │   │   │   ├── DashboardHero.jsx
    │   │   │   ├── DashboardNavigation.jsx
    │   │   │   ├── DashboardStats.jsx
    │   │   │   ├── BulkActionsButton.jsx
    │   │   │   └── StatusTabWithDropdown.jsx
    │   │   ├── editors/
    │   │   ├── hooks/
    │   │   │   └── useDashboardData.js
    │   │   ├── lib/
    │   │   │   ├── editors/
    │   │   │   ├── examples/
    │   │   │   └── utils/
    │   │   └── view-modes/
    │   │       ├── card/
    │   │       │   └── CardTemplate.jsx
    │   │       ├── list/
    │   │       │   └── ListItemTemplate.jsx
    │   │       └── table/
    │   │           └── TableRowTemplate.jsx
    │   │
    │   └── Detail/
    │       ├── index.jsx        # DetailTemplate
    │       ├── components/
    │       │   ├── DetailHero.jsx
    │       │   ├── DetailSidebar.jsx
    │       │   ├── DetailTabs.jsx
    │       │   └── DetailActivityFeed.jsx
    │       └── hooks/
    │           └── useDetailData.js
    │
    └── components/              # UI COMPONENTS
        │
        ├── auth/                # Authentication
        │   ├── LoginPage.jsx
        │   ├── RegisterPage.jsx
        │   └── ProtectedRoute.jsx
        │
        ├── admin/               # Admin components
        │   ├── AdminSecurityDashboard.jsx
        │   ├── UsersTable.jsx
        │   ├── TeamPermissionsManager.jsx
        │   └── ...
        │
        ├── common/              # SHARED COMPONENTS
        │   ├── ui/
        │   │   ├── DashboardStatCard.jsx
        │   │   ├── ClientCircles.jsx
        │   │   ├── LeadCircles.jsx
        │   │   ├── QuickActionsMenu.jsx
        │   │   ├── LoadingSpinner.jsx
        │   │   └── CopyButton.jsx
        │   │
        │   ├── modals/
        │   │   ├── EditorModal.jsx
        │   │   ├── ModalContainer.jsx
        │   │   └── ModalStepPage.jsx
        │   │
        │   ├── setters/         # Form field components
        │   │   ├── Currency.jsx
        │   │   ├── Date.jsx
        │   │   ├── Email.jsx
        │   │   └── Phone.jsx
        │   │
        │   ├── inputs/shared/
        │   │   ├── AddressInput.jsx
        │   │   ├── CurrencyInput.jsx
        │   │   ├── PhoneInput.jsx
        │   │   └── ...
        │   │
        │   ├── editors/
        │   ├── layout/
        │   ├── settings/
        │   ├── status/
        │   └── error-handling/
        │
        ├── dashboards/          # ENTITY DASHBOARDS
        │   │
        │   ├── escrows/
        │   │   ├── index.jsx    # EscrowsDashboard
        │   │   ├── editors/
        │   │   │   ├── EditPropertyAddress.jsx
        │   │   │   ├── EditPurchasePrice.jsx
        │   │   │   ├── EditClosingDate.jsx
        │   │   │   ├── EditAcceptanceDate.jsx
        │   │   │   ├── EditCommissionAmount.jsx
        │   │   │   ├── EditClients.jsx
        │   │   │   └── index.js
        │   │   ├── hero/
        │   │   │   ├── EscrowsHeroCarousel.jsx
        │   │   │   ├── AIManagerModal.jsx
        │   │   │   ├── pages/
        │   │   │   │   ├── HomePage/
        │   │   │   │   └── AIManagerPage/
        │   │   │   └── stats/
        │   │   │       ├── TotalEscrowsCard.jsx
        │   │   │       ├── TotalVolumeCard.jsx
        │   │   │       ├── TotalCommissionCard.jsx
        │   │   │       └── TotalThisMonthCard.jsx
        │   │   ├── modals/
        │   │   │   └── NewEscrowModal.jsx
        │   │   ├── navigation/
        │   │   │   ├── tabs/
        │   │   │   └── filters/
        │   │   └── view-modes/
        │   │       ├── card/EscrowCard.jsx
        │   │       ├── list/EscrowListItem.jsx
        │   │       └── table/EscrowTableRow.jsx
        │   │
        │   ├── clients/
        │   │   ├── index.jsx    # ClientsDashboard (Updated)
        │   │   ├── editors/
        │   │   │   ├── EditClientName.jsx      # Updated: single input
        │   │   │   ├── EditClientEmail.jsx
        │   │   │   ├── EditClientPhone.jsx
        │   │   │   ├── EditClientStatus.jsx
        │   │   │   ├── EditClientBudget.jsx    # Updated: numeric
        │   │   │   └── index.js
        │   │   ├── hero/
        │   │   │   ├── ClientsHeroCarousel.jsx # New: AI Manager
        │   │   │   ├── AIManagerModal.jsx      # New
        │   │   │   ├── pages/
        │   │   │   │   └── AIManagerPage/
        │   │   │   └── stats/
        │   │   │       ├── TotalClientsCard.jsx
        │   │   │       ├── ActiveClientsCard.jsx
        │   │   │       ├── NewThisMonthCard.jsx
        │   │   │       └── ClientValueCard.jsx  # Updated: Commission
        │   │   ├── modals/
        │   │   │   └── NewClientModal.jsx
        │   │   ├── navigation/
        │   │   │   ├── tabs/ClientStatusTabs.jsx
        │   │   │   └── filters/
        │   │   └── view-modes/
        │   │       ├── card/ClientCard.jsx      # Updated: budget + commission
        │   │       ├── list/ClientListItem.jsx
        │   │       └── table/ClientTableRow.jsx
        │   │
        │   ├── leads/
        │   │   ├── index.jsx    # LeadsDashboard
        │   │   ├── editors/
        │   │   ├── hero/
        │   │   │   └── stats/
        │   │   ├── modals/
        │   │   ├── navigation/
        │   │   └── view-modes/
        │   │
        │   ├── listings/
        │   │   ├── index.jsx    # ListingsDashboard
        │   │   ├── editors/
        │   │   ├── hero/
        │   │   │   └── stats/
        │   │   ├── modals/
        │   │   ├── navigation/
        │   │   └── view-modes/
        │   │
        │   ├── appointments/
        │   │   ├── index.jsx    # AppointmentsDashboard
        │   │   ├── editors/
        │   │   ├── hero/
        │   │   ├── modals/
        │   │   ├── navigation/
        │   │   └── view-modes/
        │   │
        │   └── home/            # Role-based home dashboards
        │       ├── index.jsx
        │       ├── agent/
        │       ├── broker/
        │       ├── team/
        │       └── system-admin/
        │
        └── details/             # ENTITY DETAIL PAGES
            ├── escrows/
            │   ├── index.jsx
            │   ├── components/
            │   │   ├── EscrowDetailHero.jsx
            │   │   ├── PeopleWidget_White.jsx
            │   │   ├── FinancialsWidget_White.jsx
            │   │   ├── TimelineWidget_White.jsx
            │   │   ├── ChecklistsWidget_White.jsx
            │   │   └── ActivityFeedSheet.jsx
            │   ├── hooks/
            │   └── modals/
            │
            ├── clients/
            │   └── index.jsx
            │
            ├── leads/
            │   ├── index.jsx
            │   └── components/
            │
            ├── listings/
            │   ├── index.jsx
            │   ├── components/
            │   └── modals/
            │
            └── appointments/
                ├── index.jsx
                └── components/

================================================================================
RECENT CHANGES (December 2024)
================================================================================

BACKEND UPDATES:
- backend/src/modules/core-modules/clients/services/clients.service.js
  - Added budget field to SELECT, CREATE, UPDATE queries
  - Added LATERAL JOIN for lifetime_value calculation

- backend/src/modules/core-modules/leads/services/leads.service.js
  - Added budget field to CREATE query
  - Added budget to allowed UPDATE fields

DATABASE:
- Added budget column (numeric 15,2) to clients table
- Added budget column (numeric 15,2) to leads table

FRONTEND UPDATES:
- frontend/src/components/dashboards/clients/index.jsx
  - Added HeroComponent={ClientsHeroCarousel} prop

- frontend/src/components/dashboards/clients/view-modes/card/ClientCard.jsx
  - Updated Budget metric to use client.budget directly
  - Changed "Doc Type" to "Commission" (lifetime_value)
  - Fixed Lead/Leads label logic (singular for 0-1, plural for 2+)
  - Removed unused getBudgetConfig function

- frontend/src/components/dashboards/clients/hero/stats/ClientValueCard.jsx
  - Renamed "LIFETIME VALUE" to "COMMISSION"

- frontend/src/config/statuses/statusCategories.js
  - Fixed CLIENT_CATEGORIES to match database statuses

- frontend/src/config/entities/clients.config.js
  - Changed to component-based stats (like escrows)
  - Imported navigation configs from centralized location

================================================================================
FILE COUNTS
================================================================================

Backend Modules:          23 modules
Backend Services:         ~45 service files
Backend Controllers:      ~40 controller files
Backend Tests:            ~25 test files
Backend Migrations:       52 SQL files

Frontend Components:      ~180 JSX files
Frontend Services:        13 service files
Frontend Contexts:        3 context files
Frontend Hooks:           4 custom hooks
Frontend Configs:         8 config files

Total Source Files:       ~650 files (excluding node_modules, archive)

================================================================================
END OF FILE TREE
================================================================================
